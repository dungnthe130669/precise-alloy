{"version":3,"file":"pl-states.js","sources":["../../../../xpack/scripts/pl-states.entry.ts"],"sourcesContent":["interface Theme {\n  value: string;\n  name: string;\n}\n\ninterface StateOption {\n  name: string;\n  value: string;\n}\n\ninterface State {\n  name: string;\n  options?: StateOption[];\n  multiple?: boolean;\n}\n\ninterface StateButton {\n  parentSelector?: string;\n  styleModifier: string;\n  zIndex?: number;\n}\n\ninterface ComponentState {\n  name: string;\n  selector: string;\n  button?: StateButton;\n  states: State[];\n}\n\nlet index = 100000;\n\nconst themes: Theme[] = [\n  {\n    value: 'theme-blue-p',\n    name: 'Blue',\n  },\n  {\n    value: 'theme-white-p',\n    name: 'White',\n  },\n  {\n    value: 'theme-sand-s',\n    name: 'Sand',\n  },\n  {\n    value: 'theme-flow-25',\n    name: 'Flow 25',\n  },\n  {\n    value: 'theme-wave-ac',\n    name: 'Wave',\n  },\n  {\n    value: 'theme-wave-50',\n    name: 'Wave 50',\n  },\n  {\n    value: 'theme-pearl-s',\n    name: 'Pearl',\n  },\n  {\n    value: 'theme-pebble-s',\n    name: 'Pebble',\n  },\n];\n\nconst newId = () => {\n  return 'pl-state-id-' + index++;\n};\n\nconst createSelect = (state: State, classList: DOMTokenList) => {\n  if (!state.options) {\n    return '';\n  }\n\n  const options = state.options;\n  const name = newId();\n  const header = state.multiple ? 'Select many...' : (options.find((o) => classList.contains(o.value))?.name ?? '---');\n  const type = state.multiple ? 'checkbox' : 'radio';\n\n  let optionsHtml = '';\n  options.forEach((option: StateOption) => {\n    const selectedHtml = classList.contains(option.value) ? 'checked' : '';\n    const id = newId();\n    optionsHtml +=\n      `<input name=\"${name}\" class=\"pl-state-bar__input\" type=\"${type}\" id=\"${id}\" data-name=\"${option.name}\" value=\"${option.value}\" ${selectedHtml}/>` +\n      `<label class=\"pl-state-bar__label\" for=\"${id}\"><span>${option.name}</span></label>`;\n  });\n\n  const html =\n    `<div class=\"pl-state-bar__group\">` +\n    `<div>${state.name}:</div>` +\n    `<div class=\"pl-state-bar__group-header\">${header}</div>` +\n    `<div class=\"pl-state-bar__checkbox-group\">${optionsHtml}</div>` +\n    `</div>`;\n\n  return html;\n};\n\nconst deactiveStateButtons = () => {\n  const stateButtons = [...document.querySelectorAll('.pl-state__button')];\n  stateButtons.forEach((stateButton) => stateButton.classList.remove('active'));\n};\n\nconst closeButtonClickHandler = (stateBar: HTMLElement) => {\n  stateBar.classList.remove('expand');\n  document.body.classList.remove('pl-state-expand');\n  deactiveStateButtons();\n  window.dispatchEvent(new Event('resize'));\n};\n\nconst stateButtonClickHandler = (item: HTMLElement, stateButton: HTMLElement, plState: ComponentState) => {\n  deactiveStateButtons();\n\n  const stateBar: HTMLElement | null = document.querySelector('.pl-state-bar');\n  if (!stateBar) {\n    return;\n  }\n\n  if (stateButton.classList.contains('active')) {\n    closeButtonClickHandler(stateBar);\n    return;\n  }\n\n  const stateBarContent = stateBar.querySelector('.pl-state-bar__content');\n  if (stateBarContent) {\n    let stateBarContentHtml = '';\n    let index = 0;\n    plState.states.forEach((state) => {\n      const combinedState = state.name === 'Theme' && !state.options ? { ...state, options: themes } : state;\n      stateBarContentHtml += createSelect(combinedState, item.classList);\n\n      index++;\n\n      if (index == 1) {\n        stateBarContentHtml += stateBarCloseButtonHtml();\n      }\n    });\n    stateBarContent.innerHTML = stateBarContentHtml;\n\n    const closeButton = stateBarContent.querySelector('.pl-state-bar__close-button');\n    if (closeButton) {\n      closeButton.addEventListener('click', () => closeButtonClickHandler(stateBar));\n    }\n\n    const stateBarGroups = [...stateBarContent.querySelectorAll('.pl-state-bar__group')];\n    stateBarGroups.forEach((stateBarGroup) => {\n      const stateBarGroupHeader = stateBarGroup.querySelector('.pl-state-bar__group-header');\n      const checkboxGroup = stateBarGroup.querySelector('.pl-state-bar__checkbox-group');\n      if (!stateBarGroupHeader || !checkboxGroup) {\n        return;\n      }\n\n      if (stateBarGroupHeader) {\n        stateBarGroupHeader.addEventListener('click', () => {\n          checkboxGroup.classList.toggle('expand');\n        });\n        document.addEventListener('click', (e: MouseEvent) => {\n          if (!e.target) {\n            return;\n          }\n\n          const node = e.target as Node;\n\n          if (!checkboxGroup.contains(node) && !stateBarGroupHeader.contains(node)) {\n            checkboxGroup.classList.remove('expand');\n          }\n        });\n      }\n\n      const checkboxes = stateBarGroup.querySelectorAll(\"input[type='checkbox']\");\n      [].forEach.call(checkboxes, (checkbox: HTMLInputElement) => {\n        checkbox.addEventListener('change', () => {\n          if (!checkbox.value) {\n            return;\n          }\n\n          if (checkbox.checked) {\n            item.classList.add(checkbox.value);\n          } else {\n            item.classList.remove(checkbox.value);\n          }\n          window.dispatchEvent(new Event('resize'));\n        });\n      });\n\n      const radios = stateBarGroup.querySelectorAll(\"input[type='radio']\");\n      [].forEach.call(radios, (radio: HTMLInputElement) => {\n        radio.addEventListener('change', () => {\n          [].forEach.call(radios, (r: HTMLInputElement) => {\n            if (r.value) {\n              item.classList.remove(r.value);\n            }\n          });\n          if (radio.value) {\n            item.classList.add(radio.value);\n          }\n          stateBarGroupHeader.textContent = radio.getAttribute('data-name');\n          checkboxGroup.classList.remove('expand');\n        });\n      });\n\n      const radioLabels = [...stateBarGroup.querySelectorAll(\"input[type='radio'] + label\")];\n      radioLabels.forEach((radioLabel) => {\n        radioLabel.addEventListener('click', () => {\n          checkboxGroup.classList.remove('expand');\n        });\n      });\n    });\n\n    stateBar.classList.add('expand');\n    stateButton.classList.add('active');\n    document.body.classList.add('pl-state-expand');\n    window.dispatchEvent(new Event('resize'));\n  }\n};\nconst stateBarCloseButtonHtml = () => {\n  return `<div class=\"pl-state-bar__buttons\"><a class=\"pl-state-bar__close-button\"></a></div>`;\n};\n\nconst appendButtons = (states: ComponentState[]) => {\n  const stateBarHtml = `<div class=\"pl-state-bar\"><div class=\"pl-state-bar__content\"></div>${stateBarCloseButtonHtml()}</div>`;\n\n  document.body.insertAdjacentHTML('beforeend', stateBarHtml);\n  const stateBar: HTMLElement | null = document.querySelector('.pl-state-bar');\n  if (!stateBar) {\n    return;\n  }\n\n  const closeButton = stateBar.querySelector('.pl-state-bar__close-button');\n  if (closeButton) {\n    closeButton.addEventListener('click', () => closeButtonClickHandler(stateBar));\n  }\n\n  [].forEach.call(states, (plState: ComponentState) => {\n    if (!plState || !plState.selector) {\n      return;\n    }\n\n    const buttonModifier = plState.button?.styleModifier ?? '';\n    const buttonTitle = plState.name ? `title=\"Show state modifier for: ${plState.name}\"` : '';\n    const buttonZIndex = plState.button?.zIndex ? `style=\"z-index: ${plState.button.zIndex};\"` : '';\n\n    const items = document.querySelectorAll(plState.selector);\n    [].forEach.call(items, (item: HTMLElement) => {\n      const html =\n        `<div class=\"pl-state ${buttonModifier}\" ${buttonZIndex}>` +\n        `<div class=\"pl-state__controls\">` +\n        `<button class=\"pl-state__button\" ${buttonTitle}>` +\n        `<img src=\"${import.meta.env.BASE_URL}pl-states.svg\" loading=\"async\">` +\n        `</button></div></div>`;\n\n      const stateButtonParent = plState.button?.parentSelector ? item.querySelector(plState.button.parentSelector) : item;\n      if (!stateButtonParent) {\n        return;\n      }\n      stateButtonParent.insertAdjacentHTML('beforeend', html);\n\n      const stateContainer: HTMLElement | null = stateButtonParent.querySelector(':scope > .pl-state');\n      if (!stateContainer) {\n        return;\n      }\n\n      const stateButton: HTMLElement | null = stateContainer.querySelector('.pl-state__button');\n      if (stateButton) {\n        stateButton.addEventListener('click', () => {\n          stateButtonClickHandler(item, stateButton, plState);\n        });\n      }\n    });\n  });\n\n  addEventListener('resize', function () {\n    const stateBar = document.querySelector('.pl-state-bar');\n    if (!stateBar) {\n      return;\n    }\n\n    const stateBarRect = stateBar.getBoundingClientRect();\n    document.documentElement.style.setProperty('--pl-state-bar-height', Math.ceil(stateBarRect.height) + 'px');\n  });\n};\n\nconst init = () => {\n  const localStorageKey = 'pl-show-state-selector';\n  const showStateSelector = localStorage.getItem(localStorageKey);\n\n  if (!showStateSelector) {\n    return;\n  }\n\n  fetch(import.meta.env.BASE_URL + 'pl-states.json')\n    .then((response) => response.json())\n    .then((data) => appendButtons(data));\n};\n\ninit();\n\nexport {};\n"],"names":["index","themes","newId","createSelect","state","classList","_a","options","name","header","o","type","optionsHtml","option","selectedHtml","id","deactiveStateButtons","stateButton","closeButtonClickHandler","stateBar","stateButtonClickHandler","item","plState","stateBarContent","stateBarContentHtml","combinedState","stateBarCloseButtonHtml","closeButton","stateBarGroup","stateBarGroupHeader","checkboxGroup","e","node","checkboxes","checkbox","radios","radio","r","radioLabel","appendButtons","states","stateBarHtml","_b","buttonModifier","buttonTitle","buttonZIndex","items","html","stateButtonParent","stateContainer","stateBarRect","init","response","data"],"mappings":"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"}