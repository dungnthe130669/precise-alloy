{"version":3,"file":"root.js","sources":["../../../../xpack/scripts/root.entry.ts"],"sourcesContent":["const BORDER_SIZE = 20;\r\nconst MIN_FRAME_SIZE = 350;\r\nconst MSG_IFRAME_SIZE = 'MSG_IFRAME_SIZE'\r\n\r\nlet orgWidth: number;\r\nlet pos: number;\r\n\r\nconst wrapper = document.getElementById('root-iframe-wrapper');\r\nconst frame = document.getElementById('root-iframe');\r\nconst resizer = document.getElementById('root-iframe-resizer');\r\n\r\nlet iframeSize = sessionStorage.getItem(MSG_IFRAME_SIZE);\r\n\r\nconst setIFrameWidth = (width?: number) => {\r\n  if (!wrapper) {\r\n    return;\r\n  }\r\n\r\n  if (width) {\r\n    wrapper.style.maxWidth = `min(100%, ${width}px)`;\r\n  } else {\r\n    wrapper.style.removeProperty('max-width');\r\n  }\r\n};\r\n\r\nconst resize = (e: globalThis.MouseEvent) => {\r\n  e.stopPropagation();\r\n  e.preventDefault();\r\n  const dx = (e.x - pos) * 2;\r\n\r\n  const size = Math.max(MIN_FRAME_SIZE, orgWidth + dx);\r\n  setIFrameWidth(size);\r\n  iframeSize = size + '';\r\n\r\n  return false;\r\n};\r\n\r\nconst mouseUp = () => {\r\n  if (!wrapper || !frame) {\r\n    return;\r\n  }\r\n\r\n  wrapper.style.removeProperty('transition');\r\n  frame.style.removeProperty('pointer-events');\r\n  iframeSize && sessionStorage.setItem(MSG_IFRAME_SIZE, iframeSize)\r\n\r\n  document.removeEventListener('mousemove', resize, false);\r\n};\r\n\r\nconst handleResizerMouseDown = (e: MouseEvent) => {\r\n  if (!wrapper || !frame || e.offsetX >= BORDER_SIZE) {\r\n    return;\r\n  }\r\n\r\n  wrapper.style.transition = 'none';\r\n  frame.style.pointerEvents = 'none';\r\n  pos = e.x;\r\n  orgWidth = parseInt(getComputedStyle(wrapper, '').width);\r\n  document.addEventListener('mousemove', resize, false);\r\n  document.addEventListener('mouseup', mouseUp, false);\r\n};\r\n\r\nconst initTopPanel = () => {\r\n  const isTopPanel = localStorage.getItem('MSG_IS_TOP_PANEL') === 'true';\r\n  const rootEl = document.querySelector('.xpack-t-root');\r\n\r\n  if (!rootEl) {\r\n    return;\r\n  }\r\n  if (isTopPanel) {\r\n    rootEl.classList.add('top-panel');\r\n  }\r\n};\r\n\r\nconst handleStoreModified = (event: StorageEvent) => {\r\n  switch (event.key) {\r\n    case 'MSG_IS_TOP_PANEL':\r\n      {\r\n        const isTopPanel = event.newValue === 'true';\r\n        const rootEl = document.querySelector('.xpack-t-root');\r\n\r\n        if (!rootEl) {\r\n          return;\r\n        }\r\n\r\n        if (isTopPanel) {\r\n          rootEl.classList.add('top-panel');\r\n        } else {\r\n          rootEl.classList.remove('top-panel');\r\n        }\r\n        break;\r\n      }\r\n  }\r\n};\r\n\r\nconst addStoreEvent = () => {\r\n  window.addEventListener('storage', handleStoreModified);\r\n};\r\n\r\nconst setup = () => {\r\n  if (!resizer || !frame) {\r\n    return;\r\n  }\r\n\r\n  resizer.onmousedown = handleResizerMouseDown;\r\n  setIFrameWidth(iframeSize ? parseInt(iframeSize) : undefined)\r\n\r\n  const getIFrameActualWidth = () => {\r\n    const el = document.getElementById('root-actual-iframe-width');\r\n    if (el) {\r\n      el.textContent = Math.ceil(parseInt(getComputedStyle(frame).width)) + 'px';\r\n    }\r\n  };\r\n\r\n  frame.onload = getIFrameActualWidth;\r\n\r\n  if ('ResizeObserver' in window) {\r\n    // create an Observer instance\r\n    const resizeObserver = new ResizeObserver(getIFrameActualWidth);\r\n\r\n    // start observing a DOM node\r\n    resizeObserver.observe(frame);\r\n  }\r\n  initTopPanel();\r\n  addStoreEvent();\r\n\r\n  if (wrapper) {\r\n    window.onload = () => wrapper.classList.add('initialized');\r\n  }\r\n};\r\n\r\nsetup();\r\n\r\nexport { };\r\n"],"names":["MSG_IFRAME_SIZE","orgWidth","pos","wrapper","frame","resizer","iframeSize","setIFrameWidth","width","resize","dx","size","mouseUp","handleResizerMouseDown","initTopPanel","isTopPanel","rootEl","handleStoreModified","event","addStoreEvent","setup","getIFrameActualWidth","el"],"mappings":"AAEA,MAAMA,EAAkB,kBAExB,IAAIC,EACAC,EAEJ,MAAMC,EAAU,SAAS,eAAe,qBAAqB,EACvDC,EAAQ,SAAS,eAAe,aAAa,EAC7CC,EAAU,SAAS,eAAe,qBAAqB,EAE7D,IAAIC,EAAa,eAAe,QAAQN,CAAe,EAEvD,MAAMO,EAAkBC,GAAmB,CACpCL,IAIDK,EACML,EAAA,MAAM,SAAW,aAAaK,CAAK,MAEnCL,EAAA,MAAM,eAAe,WAAW,EAE5C,EAEMM,EAAU,GAA6B,CAC3C,EAAE,gBAAgB,EAClB,EAAE,eAAe,EACX,MAAAC,GAAM,EAAE,EAAIR,GAAO,EAEnBS,EAAO,KAAK,IAAI,IAAgBV,EAAWS,CAAE,EACnD,OAAAH,EAAeI,CAAI,EACnBL,EAAaK,EAAO,GAEb,EACT,EAEMC,EAAU,IAAM,CAChB,CAACT,GAAW,CAACC,IAITD,EAAA,MAAM,eAAe,YAAY,EACnCC,EAAA,MAAM,eAAe,gBAAgB,EAC7BE,GAAA,eAAe,QAAQN,EAAiBM,CAAU,EAEvD,SAAA,oBAAoB,YAAaG,EAAQ,EAAK,EACzD,EAEMI,EAA0B,GAAkB,CAC5C,CAACV,GAAW,CAACC,GAAS,EAAE,SAAW,KAIvCD,EAAQ,MAAM,WAAa,OAC3BC,EAAM,MAAM,cAAgB,OAC5BF,EAAM,EAAE,EACRD,EAAW,SAAS,iBAAiBE,EAAS,EAAE,EAAE,KAAK,EAC9C,SAAA,iBAAiB,YAAaM,EAAQ,EAAK,EAC3C,SAAA,iBAAiB,UAAWG,EAAS,EAAK,EACrD,EAEME,EAAe,IAAM,CACzB,MAAMC,EAAa,aAAa,QAAQ,kBAAkB,IAAM,OAC1DC,EAAS,SAAS,cAAc,eAAe,EAEhDA,GAGDD,GACKC,EAAA,UAAU,IAAI,WAAW,CAEpC,EAEMC,EAAuBC,GAAwB,CACnD,OAAQA,EAAM,IAAK,CACjB,IAAK,mBACH,CACQ,MAAAH,EAAaG,EAAM,WAAa,OAChCF,EAAS,SAAS,cAAc,eAAe,EAErD,GAAI,CAACA,EACH,OAGED,EACKC,EAAA,UAAU,IAAI,WAAW,EAEzBA,EAAA,UAAU,OAAO,WAAW,EAErC,KAAA,CACF,CAEN,EAEMG,EAAgB,IAAM,CACnB,OAAA,iBAAiB,UAAWF,CAAmB,CACxD,EAEMG,EAAQ,IAAM,CACd,GAAA,CAACf,GAAW,CAACD,EACf,OAGFC,EAAQ,YAAcQ,EACtBN,EAAeD,EAAa,SAASA,CAAU,EAAI,MAAS,EAE5D,MAAMe,EAAuB,IAAM,CAC3B,MAAAC,EAAK,SAAS,eAAe,0BAA0B,EACzDA,IACCA,EAAA,YAAc,KAAK,KAAK,SAAS,iBAAiBlB,CAAK,EAAE,KAAK,CAAC,EAAI,KAE1E,EAEAA,EAAM,OAASiB,EAEX,mBAAoB,QAEC,IAAI,eAAeA,CAAoB,EAG/C,QAAQjB,CAAK,EAEjBU,EAAA,EACCK,EAAA,EAEVhB,IACF,OAAO,OAAS,IAAMA,EAAQ,UAAU,IAAI,aAAa,EAE7D,EAEAiB,EAAM"}